<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Interventions - Therapy Docs</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">

    <!-- Critical CSS to prevent FOUC -->
    <style>[x-cloak] { display: none !important; }</style>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="dist/output.css">

    <!-- Application Entry Point (ES Module) - includes Alpine.js -->
    <script type="module" src="js/entries/interventions.entry.js"></script>

    <style>
        /* Section headers */
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: var(--color-neutral-50);
            border-bottom: 1px solid var(--color-neutral-200);
            cursor: pointer;
            user-select: none;
        }

        .section-header:hover {
            background: var(--color-neutral-100);
        }

        .section-header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-icon {
            font-size: 1rem;
            width: 24px;
            text-align: center;
        }

        .section-title {
            font-weight: 700;
            font-size: 0.875rem;
            color: var(--color-neutral-800);
        }

        .section-count {
            font-size: 0.75rem;
            color: var(--color-neutral-500);
            font-weight: 400;
        }

        .section-chevron {
            color: var(--color-neutral-400);
            transition: transform 200ms;
        }

        .section-header.expanded .section-chevron {
            transform: rotate(180deg);
        }

        /* Intervention list */
        .intervention-list {
            border-top: 1px solid var(--color-neutral-100);
        }

        .intervention-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1rem;
            border-bottom: 1px solid var(--color-neutral-100);
            min-height: 56px;
        }

        .intervention-item:last-child {
            border-bottom: none;
        }

        .intervention-item:hover {
            background: var(--color-neutral-50);
        }

        .intervention-label {
            flex: 1;
            font-size: 0.9375rem;
            color: var(--color-neutral-800);
        }

        .intervention-label .custom-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            margin-left: 0.5rem;
            padding: 0.125rem 0.5rem;
            background: var(--color-warning-100);
            color: var(--color-warning-700);
            border-radius: 9999px;
            font-size: 0.625rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .intervention-approaches {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
        }

        .intervention-actions {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Action buttons */
        .action-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 0.5rem;
            color: var(--color-neutral-400);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 150ms;
        }

        .action-btn:hover {
            background: var(--color-neutral-100);
            color: var(--color-neutral-600);
        }

        .action-btn.favorite {
            color: var(--color-warning-400);
        }

        .action-btn.favorite:hover {
            color: var(--color-warning-500);
            background: var(--color-warning-50);
        }

        .action-btn.favorite.active {
            color: var(--color-warning-500);
        }

        .action-btn.hide:hover {
            color: var(--color-neutral-600);
            background: var(--color-neutral-200);
        }

        .action-btn.show:hover {
            color: var(--color-success-600);
            background: var(--color-success-50);
        }

        .action-btn.delete:hover {
            color: var(--color-danger-600);
            background: var(--color-danger-50);
        }

        /* Search and filter bar */
        .toolbar {
            display: flex;
            gap: 0.75rem;
            padding: 1rem;
            background: white;
            border-bottom: 1px solid var(--color-neutral-200);
        }

        .search-container {
            flex: 1 1 auto;
            min-width: 0;
            position: relative;
        }

        .search-container .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--color-neutral-400);
            pointer-events: none;
        }

        .search-container input {
            padding-left: 2.75rem;
        }

        .filter-select {
            flex: 0 0 auto;
            width: 200px;
        }

        /* Empty state */
        .my-interventions-empty-state {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--color-neutral-500);
        }

        .my-interventions-empty-state i {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            color: var(--color-neutral-300);
        }

        /* Add intervention form */
        .add-form-container {
            padding: 1rem;
            background: var(--color-neutral-50);
            border-top: 1px solid var(--color-neutral-200);
        }

        .add-form {
            background: white;
            border: 2px dashed var(--color-neutral-300);
            border-radius: 0.5rem;
            padding: 1.25rem;
        }

        .add-form.active {
            border-style: solid;
            border-color: var(--color-primary-300);
        }

        .add-form-trigger {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 100%;
            padding: 0.75rem;
            color: var(--color-neutral-500);
            font-weight: 600;
            cursor: pointer;
            transition: color 150ms;
            background: transparent;
            border: none;
        }

        .add-form-trigger:hover {
            color: var(--color-primary-600);
        }

        .add-form-fields {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .approach-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .approach-checkbox {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.5rem 0.75rem;
            background: white;
            border: 1px solid var(--color-neutral-300);
            border-radius: 0.375rem;
            font-size: 0.8125rem;
            color: var(--color-neutral-700);
            cursor: pointer;
            transition: all 150ms;
        }

        .approach-checkbox:hover {
            border-color: var(--color-primary-400);
            background: var(--color-primary-50);
        }

        .approach-checkbox.checked {
            border-color: var(--color-primary-500);
            background: var(--color-primary-100);
            color: var(--color-primary-700);
        }

        .form-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            margin-top: 0.5rem;
        }

        /* Stats section */
        .stats-bar {
            display: flex;
            gap: 1.5rem;
            padding: 1rem;
            background: var(--color-neutral-50);
            border-bottom: 1px solid var(--color-neutral-200);
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 0.5rem;
            color: var(--color-neutral-500);
        }

        .stat-content {
            display: flex;
            flex-direction: column;
        }

        .stat-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--color-neutral-800);
            line-height: 1.2;
        }

        .stat-label {
            font-size: 0.6875rem;
            color: var(--color-neutral-500);
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        /* Collapsible sections */
        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 300ms ease-out;
        }

        .section-content.expanded {
            max-height: 600px;
            overflow-y: auto;
        }
    </style>
</head>
<body x-data="myInterventions" class="bg-neutral-50 min-h-screen" :class="{ 'mock-watermark': window.config?.useMockAPI }">

    <!-- Shared Navigation Drawer -->
    <div id="nav-drawer"></div>

    <!-- Header -->
    <header class="bg-white border-b border-neutral-200 sticky top-0 z-40 shadow-sm">
        <div class="max-w-full px-4">
            <div class="py-3 flex items-center gap-3">
                <!-- Menu Button -->
                <button @click="drawerOpen = true" class="hamburger-btn">
                    <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#menu-hamburger"></use></svg>
                </button>

                <!-- Title -->
                <div class="flex-1 min-w-0 flex items-center gap-3">
                    <h1 class="text-lg font-bold text-neutral-900 flex items-center">
                        <svg class="icon mr-2 text-primary-500"><use href="./assets/icons/tabler-sprites.svg#interventions"></use></svg>
                        My Interventions
                    </h1>
                    <p class="text-sm text-neutral-500 hidden sm:block">Manage your personal intervention library</p>
                </div>

                <!-- Save Status -->
                <div class="flex items-center gap-3">
                    <div x-show="saveStatus === 'saving'" x-cloak class="text-neutral-500 text-sm">
                        <blob-spinner class="icon-sm mr-1"></blob-spinner>Saving...
                    </div>
                    <div x-show="saveStatus === 'saved'" x-cloak x-transition class="text-success-600 text-sm">
                        <svg class="icon icon-sm mr-1"><use href="./assets/icons/tabler-sprites.svg#selected"></use></svg>Saved
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Search and Filter Toolbar -->
    <div class="toolbar sticky top-0 z-30">
        <div class="search-container">
            <svg class="icon search-icon"><use href="./assets/icons/tabler-sprites.svg#search"></use></svg>
            <input
                type="text"
                class="form-input"
                placeholder="Search interventions..."
                x-model="searchQuery"
            >
        </div>
        <select class="form-select filter-select" x-model="filterApproach">
            <option value="all">All Approaches</option>
            <template x-for="approach in getVisibleApproaches()" :key="approach.value">
                <option :value="approach.value" x-text="approach.name"></option>
            </template>
        </select>
    </div>

    <!-- Main Content -->
    <main class="container-narrow py-4">
        <!-- Loading State -->
        <div x-show="loading" class="text-center py-16">
            <blob-spinner class="icon-2xl text-primary-600 mb-4 mx-auto"></blob-spinner>
            <p class="text-neutral-500">Loading interventions...</p>
        </div>

        <div x-show="!loading" x-cloak>
            <!-- Therapeutic Approaches Section -->
            <div class="collapsible-card mb-6">
                <div class="collapsible-header" @click="sections.approaches = !sections.approaches">
                    <span class="collapsible-title">
                        <svg class="icon text-primary-600"><use href="./assets/icons/tabler-sprites.svg#approaches"></use></svg>
                        Therapeutic Approaches
                        <span class="text-sm font-normal text-neutral-500">(<span x-text="getVisibleApproaches().length"></span> visible)</span>
                    </span>
                    <svg class="icon transition-transform" :class="{ 'rotate-180': sections.approaches }"><use href="./assets/icons/tabler-sprites.svg#expand"></use></svg>
                </div>
                <div class="collapsible-body" x-show="sections.approaches" x-collapse>
                    <!-- Visible Approaches List -->
                    <div class="intervention-list">
                        <template x-for="approach in getVisibleApproaches()" :key="approach.value">
                            <div class="intervention-item">
                                <!-- Normal view -->
                                <template x-if="editingApproach?.value !== approach.value">
                                    <div class="intervention-label flex-1">
                                        <span x-text="approach.name"></span>
                                        <span
                                            class="custom-badge"
                                            :style="approach.isBuiltIn ? 'background: var(--color-neutral-100); color: var(--color-neutral-600);' : ''"
                                            x-text="approach.isBuiltIn ? 'Built-in' : 'Custom'"
                                        ></span>
                                    </div>
                                </template>
                                <!-- Edit view -->
                                <template x-if="editingApproach?.value === approach.value">
                                    <div class="flex-1 flex items-center gap-2">
                                        <input type="text" class="form-input flex-1" x-model="editApproachForm.name" placeholder="Display name">
                                        <button class="btn btn-primary btn-icon" @click="saveEditedApproach()" title="Save">
                                            <svg class="icon icon-sm"><use href="./assets/icons/tabler-sprites.svg#selected"></use></svg>
                                        </button>
                                        <button class="btn btn-secondary btn-icon" @click="cancelEditApproach()" title="Cancel">
                                            <svg class="icon icon-sm"><use href="./assets/icons/tabler-sprites.svg#close"></use></svg>
                                        </button>
                                    </div>
                                </template>
                                <!-- Info (hide during edit) -->
                                <template x-if="editingApproach?.value !== approach.value">
                                    <div class="text-sm text-neutral-500 mr-2">
                                        <span x-text="approach.interventionCount"></span> interventions
                                    </div>
                                </template>
                                <!-- Actions (hide during edit) -->
                                <template x-if="editingApproach?.value !== approach.value">
                                    <div class="intervention-actions">
                                        <template x-if="!approach.isBuiltIn">
                                            <button class="action-btn" @click.stop="openEditApproach(approach)" title="Edit">
                                                <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-edit"></use></svg>
                                            </button>
                                        </template>
                                        <button class="action-btn hide" @click.stop="openHideApproachModal(approach)" title="Hide">
                                            <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-hide"></use></svg>
                                        </button>
                                        <template x-if="!approach.isBuiltIn">
                                            <button class="action-btn delete" @click.stop="openDeleteApproachModal(approach)" title="Delete">
                                                <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-delete"></use></svg>
                                            </button>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </template>
                    </div>

                    <!-- Hidden Approaches subsection -->
                    <template x-if="getHiddenApproaches().length > 0">
                        <div class="border-t border-neutral-200 mt-2 pt-2">
                            <div class="px-4 py-2 text-xs font-semibold text-neutral-500 uppercase">Hidden Approaches</div>
                            <div class="intervention-list">
                                <template x-for="approach in getHiddenApproaches()" :key="approach.value">
                                    <div class="intervention-item" style="opacity: 0.6;">
                                        <div class="intervention-label">
                                            <span x-text="approach.name"></span>
                                            <span
                                                class="custom-badge"
                                                :style="approach.isBuiltIn ? 'background: var(--color-neutral-100); color: var(--color-neutral-600);' : ''"
                                                x-text="approach.isBuiltIn ? 'Built-in' : 'Custom'"
                                            ></span>
                                        </div>
                                        <div class="intervention-actions">
                                            <button class="action-btn show" @click.stop="unhideApproach(approach.value)" title="Show">
                                                <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#unhide"></use></svg>
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>

                    <!-- Add Custom Approach Form -->
                    <div class="add-form-container border-t border-neutral-200">
                        <div class="add-form" :class="{ 'active': showAddApproachForm }">
                            <div x-show="!showAddApproachForm">
                                <button class="add-form-trigger" @click="openAddApproachForm()">
                                    <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-add"></use></svg> Add Custom Approach
                                </button>
                            </div>
                            <div x-show="showAddApproachForm" class="add-form-fields">
                                <div class="form-group">
                                    <label class="form-label">Display Name *</label>
                                    <input type="text" class="form-input" placeholder="e.g., Narrative Therapy" x-model="newApproach.name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Value (optional)</label>
                                    <input type="text" class="form-input" placeholder="Auto-generated if blank" x-model="newApproach.value">
                                    <p class="text-xs text-neutral-500 mt-1">Used internally for matching. Leave blank to auto-generate from name.</p>
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-secondary" @click="cancelAddApproachForm()">Cancel</button>
                                    <button class="btn btn-primary" @click="addCustomApproach()" :disabled="!newApproach.name.trim()">
                                        <svg class="icon icon-sm mr-1"><use href="./assets/icons/tabler-sprites.svg#action-add"></use></svg> Add Approach
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Favorites Section -->
            <div class="collapsible-card mb-6">
                <div class="collapsible-header" @click="sections.favorites = !sections.favorites">
                    <span class="collapsible-title">
                        <svg class="icon text-primary-600"><use href="./assets/icons/tabler-sprites.svg#bookmarked"></use></svg>
                        Favorites
                        <span class="text-sm font-normal text-neutral-500">(<span x-text="getFavoriteInterventions().length"></span>)</span>
                    </span>
                    <svg class="icon transition-transform" :class="{ 'rotate-180': sections.favorites && getFavoriteInterventions().length > 0 }"><use href="./assets/icons/tabler-sprites.svg#expand"></use></svg>
                </div>
                <div class="collapsible-body" x-show="sections.favorites && getFavoriteInterventions().length > 0" x-collapse>
                    <div class="intervention-list">
                        <template x-for="intervention in getFavoriteInterventions()" :key="intervention.id">
                            <div class="intervention-item">
                                <div class="intervention-label">
                                    <span x-text="intervention.label"></span>
                                    <template x-if="isCustom(intervention.id)">
                                        <span class="custom-badge">
                                            <svg class="icon icon-xs"><use href="./assets/icons/tabler-sprites.svg#user"></use></svg> Custom
                                        </span>
                                    </template>
                                </div>
                                <div class="intervention-approaches">
                                    <template x-for="approach in intervention.approaches" :key="approach">
                                        <span class="approach-tag" x-text="getApproachName(approach)"></span>
                                    </template>
                                </div>
                                <div class="intervention-actions">
                                    <button
                                        class="group action-btn favorite active"
                                        @click="toggleFavorite(intervention.id)"
                                        title="Remove from favorites"
                                    >
                                        <svg class="icon group-hover:hidden"><use href="./assets/icons/tabler-sprites.svg#bookmarked"></use></svg>
                                        <svg class="icon hidden group-hover:block"><use href="./assets/icons/tabler-sprites.svg#action-remove-bookmark"></use></svg>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>

            <!-- All Interventions Section -->
            <div class="collapsible-card mb-6">
                <div class="collapsible-header" @click="sections.all = !sections.all">
                    <span class="collapsible-title">
                        <svg class="icon text-primary-600"><use href="./assets/icons/tabler-sprites.svg#interventions-visible"></use></svg>
                        All Interventions
                        <span class="text-sm font-normal text-neutral-500">(<span x-text="getFilteredInterventions().length"></span>)</span>
                    </span>
                    <svg class="icon transition-transform" :class="{ 'rotate-180': sections.all }"><use href="./assets/icons/tabler-sprites.svg#expand"></use></svg>
                </div>
                <div class="collapsible-body" x-show="sections.all" x-collapse>
                    <div x-show="getFilteredInterventions().length === 0" class="my-interventions-empty-state">
                        <svg class="icon icon-lg mx-auto"><use href="./assets/icons/tabler-sprites.svg#search"></use></svg>
                        <p>No interventions match your search</p>
                    </div>
                    <div class="intervention-list">
                        <template x-for="intervention in getFilteredInterventions()" :key="intervention.id">
                            <div class="intervention-item">
                                <div class="intervention-label">
                                    <span x-text="intervention.label"></span>
                                    <template x-if="isCustom(intervention.id)">
                                        <span class="custom-badge">
                                            <svg class="icon icon-xs"><use href="./assets/icons/tabler-sprites.svg#user"></use></svg> Custom
                                        </span>
                                    </template>
                                </div>
                                <div class="intervention-approaches">
                                    <template x-for="approach in intervention.approaches" :key="approach">
                                        <span class="approach-tag" x-text="getApproachName(approach)"></span>
                                    </template>
                                </div>
                                <div class="intervention-actions">
                                    <button
                                        class="group action-btn favorite"
                                        :class="{ 'active': isFavorite(intervention.id) }"
                                        @click="toggleFavorite(intervention.id)"
                                        :title="isFavorite(intervention.id) ? 'Remove from favorites' : 'Add to favorites'"
                                    >
                                        <svg class="icon group-hover:hidden"><use :href="isFavorite(intervention.id) ? './assets/icons/tabler-sprites.svg#bookmarked' : './assets/icons/tabler-sprites.svg#not-bookmarked'"></use></svg>
                                        <svg class="icon hidden group-hover:block"><use :href="isFavorite(intervention.id) ? './assets/icons/tabler-sprites.svg#action-remove-bookmark' : './assets/icons/tabler-sprites.svg#action-add-bookmark'"></use></svg>
                                    </button>
                                    <button
                                        class="action-btn hide"
                                        @click="toggleHidden(intervention.id)"
                                        title="Hide this intervention"
                                    >
                                        <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-hide"></use></svg>
                                    </button>
                                    <template x-if="isCustom(intervention.id)">
                                        <button
                                            class="action-btn delete"
                                            @click="deleteCustomIntervention(intervention.id)"
                                            title="Delete custom intervention"
                                        >
                                            <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-delete"></use></svg>
                                        </button>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>

                    <!-- Add Custom Intervention -->
                    <div class="add-form-container">
                        <div class="add-form" :class="{ 'active': showAddForm }">
                            <div x-show="!showAddForm">
                                <button class="add-form-trigger" @click="showAddForm = true">
                                    <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#action-add"></use></svg>
                                    Add Custom Intervention
                                </button>
                            </div>
                            <div x-show="showAddForm" class="add-form-fields">
                                <div class="form-group">
                                    <label class="form-label">Intervention Label</label>
                                    <input
                                        type="text"
                                        class="form-input"
                                        placeholder="e.g., Explored cognitive distortions"
                                        x-model="newIntervention.label"
                                    >
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Theme/Keyword (for search)</label>
                                    <input
                                        type="text"
                                        class="form-input"
                                        placeholder="e.g., cognitive distortions"
                                        x-model="newIntervention.theme"
                                    >
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Therapeutic Approaches</label>
                                    <div class="approach-checkboxes">
                                        <template x-for="approach in getVisibleApproaches()" :key="approach.value">
                                            <button
                                                type="button"
                                                class="approach-checkbox"
                                                :class="{ 'checked': newIntervention.approaches.includes(approach.value) }"
                                                @click="toggleApproach(approach.value)"
                                            >
                                                <svg class="icon icon-sm"><use :href="newIntervention.approaches.includes(approach.value) ? './assets/icons/tabler-sprites.svg#checkbox-checked' : './assets/icons/tabler-sprites.svg#checkbox-unchecked'"></use></svg>
                                                <span x-text="approach.name"></span>
                                            </button>
                                        </template>
                                    </div>
                                </div>
                                <div class="form-actions">
                                    <button class="btn btn-secondary" @click="cancelAddForm()">Cancel</button>
                                    <button class="btn btn-primary" @click="addCustomIntervention()" :disabled="!newIntervention.label.trim()">
                                        <svg class="icon icon-sm mr-1"><use href="./assets/icons/tabler-sprites.svg#action-add"></use></svg> Add Intervention
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hidden Interventions Section -->
            <div class="collapsible-card mb-6" x-show="preferences.hidden.length > 0">
                <div class="collapsible-header" @click="sections.hidden = !sections.hidden">
                    <span class="collapsible-title">
                        <svg class="icon text-neutral-400"><use href="./assets/icons/tabler-sprites.svg#hidden"></use></svg>
                        Hidden
                        <span class="text-sm font-normal text-neutral-500">(<span x-text="getHiddenInterventions().length"></span>)</span>
                    </span>
                    <svg class="icon transition-transform" :class="{ 'rotate-180': sections.hidden }"><use href="./assets/icons/tabler-sprites.svg#expand"></use></svg>
                </div>
                <div class="collapsible-body" x-show="sections.hidden" x-collapse>
                    <div class="intervention-list">
                        <template x-for="intervention in getHiddenInterventions()" :key="intervention.id">
                            <div class="intervention-item" style="opacity: 0.6;">
                                <div class="intervention-label">
                                    <span x-text="intervention.label"></span>
                                </div>
                                <div class="intervention-actions">
                                    <button
                                        class="action-btn show"
                                        @click="toggleHidden(intervention.id)"
                                        title="Show this intervention"
                                    >
                                        <svg class="icon"><use href="./assets/icons/tabler-sprites.svg#unhide"></use></svg>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Hide Approach Modal -->
    <div
        x-show="showHideApproachModal"
        x-transition
        class="modal-overlay"
        @click.self="closeHideApproachModal()"
        @keydown.escape.window="closeHideApproachModal()"
        x-cloak
    >
        <div class="card w-full max-w-md bg-white">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 rounded-lg bg-neutral-100 flex items-center justify-center">
                    <svg class="icon text-neutral-600"><use href="./assets/icons/tabler-sprites.svg#hidden"></use></svg>
                </div>
                <h2 class="text-xl font-bold text-neutral-900">Hide Approach</h2>
            </div>
            <p class="text-neutral-600 mb-4">
                Hide "<span class="font-semibold" x-text="pendingHideApproach?.name"></span>" from filter tabs?
            </p>
            <template x-if="affectedInterventionsForHide.length > 0">
                <div class="bg-neutral-50 rounded-lg p-4 mb-4 border border-neutral-200">
                    <label class="flex items-start gap-3 cursor-pointer">
                        <input type="checkbox" class="form-checkbox mt-1" x-model="hideApproachAlsoHideInterventions">
                        <div>
                            <span class="font-medium text-neutral-800">Also hide interventions tagged only with this approach</span>
                            <p class="text-sm text-neutral-500 mt-1">
                                <span x-text="affectedInterventionsForHide.length"></span> intervention(s) affected
                            </p>
                        </div>
                    </label>
                    <div x-show="hideApproachAlsoHideInterventions" class="mt-3 max-h-32 overflow-y-auto border rounded bg-white">
                        <template x-for="intervention in affectedInterventionsForHide" :key="intervention.id">
                            <div class="px-3 py-2 text-sm text-neutral-600 border-b last:border-b-0" x-text="intervention.label"></div>
                        </template>
                    </div>
                </div>
            </template>
            <div class="flex gap-3 justify-end">
                <button class="btn btn-secondary" @click="closeHideApproachModal()">Cancel</button>
                <button class="btn btn-primary" @click="confirmHideApproach()">
                    <svg class="icon icon-sm mr-1"><use href="./assets/icons/tabler-sprites.svg#action-hide"></use></svg> Hide Approach
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Approach Modal -->
    <div
        x-show="showDeleteApproachModal"
        x-transition
        class="modal-overlay"
        @click.self="closeDeleteApproachModal()"
        @keydown.escape.window="closeDeleteApproachModal()"
        x-cloak
    >
        <div class="card w-full max-w-md bg-white">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 rounded-lg bg-danger-100 flex items-center justify-center">
                    <svg class="icon text-danger-600"><use href="./assets/icons/tabler-sprites.svg#action-delete"></use></svg>
                </div>
                <h2 class="text-xl font-bold text-neutral-900">Delete Approach</h2>
            </div>
            <p class="text-neutral-600 mb-4">
                Delete "<span class="font-semibold" x-text="pendingDeleteApproach?.name"></span>"?
            </p>
            <div class="bg-warning-50 border border-warning-200 rounded-lg p-3 mb-4">
                <p class="text-warning-800 text-sm">
                    <svg class="icon icon-sm mr-1 inline-block"><use href="./assets/icons/tabler-sprites.svg#warning"></use></svg> This cannot be undone.
                </p>
            </div>
            <template x-if="affectedInterventionsForDelete.length > 0">
                <div class="bg-neutral-50 rounded-lg p-4 mb-4 border">
                    <p class="font-medium text-neutral-800 mb-2">
                        Will be removed from <span x-text="affectedInterventionsForDelete.length"></span> custom intervention(s):
                    </p>
                    <div class="max-h-32 overflow-y-auto border rounded bg-white">
                        <template x-for="intervention in affectedInterventionsForDelete" :key="intervention.id">
                            <div class="px-3 py-2 text-sm text-neutral-600 border-b last:border-b-0" x-text="intervention.label"></div>
                        </template>
                    </div>
                </div>
            </template>
            <div class="flex gap-3 justify-end">
                <button class="btn btn-secondary" @click="closeDeleteApproachModal()">Cancel</button>
                <button class="btn btn-danger" @click="confirmDeleteApproach()">
                    <svg class="icon icon-sm mr-1"><use href="./assets/icons/tabler-sprites.svg#action-delete"></use></svg> Delete
                </button>
            </div>
        </div>
    </div>
</body>
</html>
